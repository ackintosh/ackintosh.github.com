<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ruby | 暁]]></title>
  <link href="http://ackintosh.github.com/blog/categories/ruby/atom.xml" rel="self"/>
  <link href="http://ackintosh.github.com/"/>
  <updated>2012-09-02T17:23:03+09:00</updated>
  <id>http://ackintosh.github.com/</id>
  <author>
    <name><![CDATA[Ackintosh]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[HerokuのWebサーバーをUnicornに変更する]]></title>
    <link href="http://ackintosh.github.com/blog/2012/08/28/using-the-unicorn-in-heroku/"/>
    <updated>2012-08-28T01:34:00+09:00</updated>
    <id>http://ackintosh.github.com/blog/2012/08/28/using-the-unicorn-in-heroku</id>
    <content type="html"><![CDATA[<p>最近PHPネタばかりだったので、頑張ってRailsについて書いてみます。<br/>
RailsではデフォルトでWEBrickが起動しますが、低速なので本番運用には向かないとされています。</p>

<p><a href="http://www.amazon.co.jp/WEB-DB-PRESS-Vol-70-%E6%88%90%E7%94%B0/dp/4774151904">WEB+DB PRESS Vol.70</a><br/>
<img src="https://dl.dropbox.com/u/22083548/octopress/20120827/webdb_vol70.jpeg" alt="WEB+DB PRESS Vol.70" /><br/>
WEB+DB PRESS vol.70でRails高速化としてUnicornが紹介されています。<br/>
普段Railsで開発するときはherokuを使っているので<br/>
herokuでUnicornを使ってみたいと思います。</p>

<!-- more -->


<h2>heroku ps を確認</h2>

<p>まずはherokuで現在使われているWebサーバーを確認します。</p>

<pre><code>$ heroku ps
</code></pre>

<p><img src="https://dl.dropbox.com/u/22083548/octopress/20120827/heroku_ps_thin.png" alt="heroku_ps" /></p>

<p>herokuのデフォルトはthinなのでしょうか？？<br/>
以下、Unicornのインストールを進めていきます。</p>

<h2>Gemfileに追加</h2>

<pre><code>gem 'unicorn'
</code></pre>

<h2>config/unicorn.rbを作成</h2>

<p>とりあえず設定内容は下記にしました。<br/>
詳しいことは勉強中です。すみません。</p>

<pre><code>worker_processes 2
timeout 20
preload_app false
stdout_path "log/unicorn-out.log"
stderr_path "log/unicorn-err.log"
</code></pre>

<h2>Procfileを作成</h2>

<p>Railsのルートディレクトリ直下にProcfileを作成します。</p>

<pre><code>web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb  
</code></pre>

<h2>herokuにpush</h2>

<p>いつものようにherokuにpushします。</p>

<pre><code>$ git push heroku master
</code></pre>

<h2>heroku ps で確認</h2>

<pre><code>$ heroku ps
</code></pre>

<p><img src="https://dl.dropbox.com/u/22083548/octopress/20120827/heroku_ps_unicorn.png" alt="heroku_ps_unicorn" /></p>

<p>bundle exec unicorn …となっていれば成功です。<br/>
heroku psの出力の2行目が</p>

<pre><code>web.1: crashed for…
</code></pre>

<p>になっていたら設定を見なおしてみてください。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rubyで日本語を扱う]]></title>
    <link href="http://ackintosh.github.com/blog/2012/07/14/use-japanese-in-ruby/"/>
    <updated>2012-07-14T17:30:00+09:00</updated>
    <id>http://ackintosh.github.com/blog/2012/07/14/use-japanese-in-ruby</id>
    <content type="html"><![CDATA[<p>Ruby1.9以降では</p>

<pre><code># encoding : 文字コード
</code></pre>

<p>をスクリプトの１行目に書いて文字コードを指定する。</p>

<p>実際のファイルの文字コードと一致していなければならない。</p>

<pre><code># encoding : utf-8
# encoding : shift_jis
# encoding : euc-jp
</code></pre>

<p>shift_jisだけアンダースコア…</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[rbenvを使う]]></title>
    <link href="http://ackintosh.github.com/blog/2012/07/08/use-rbenv/"/>
    <updated>2012-07-08T03:11:00+09:00</updated>
    <id>http://ackintosh.github.com/blog/2012/07/08/use-rbenv</id>
    <content type="html"><![CDATA[<h2>インストール可能な一覧</h2>

<p>$ rbenv install</p>

<h2>インストール</h2>

<p>$ rbenv install 1.9.2-p320</p>

<h2>インストールされているバージョンを確認</h2>

<p>$ rbenv versions</p>

<h2>通常使うバージョンを指定</h2>

<p>$ rbenv global 1.9.3-p194
$ rbenv rehash</p>

<h2>不要になったRubyを削除</h2>

<p>$ rbenv -rf .rbenv/versions/1.8.6-p420</p>

<h2>ディレクトリで使うrubyのバージョンを固定する</h2>

<p>$ rbenv local 1.9.2-p320
→ .rbenv-version ファイルが作られて、その中に選択したバージョンが書き込まれる</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[rbenvでrubyをインストールする時にエラー]]></title>
    <link href="http://ackintosh.github.com/blog/2012/07/08/rvenvderubywoinsutorusurushi-niera/"/>
    <updated>2012-07-08T00:01:00+09:00</updated>
    <id>http://ackintosh.github.com/blog/2012/07/08/rvenvderubywoinsutorusurushi-niera</id>
    <content type="html"><![CDATA[<h3>rbenvでrubyをインストールする時に下記のエラーがでる場合</h3>

<p>readline.c: In function ‘username_completion_proc_call’:<br/>
readline.c:1386: error: ‘username_completion_function’ undeclared (first use in this function)<br/>
readline.c:1386: error: (Each undeclared identifier is reported only once<br/>
readline.c:1386: error: for each function it appears in.)<br/>
make[1]: *** [readline.o] Error 1<br/>
make: *** [mkmain.sh] Error 1</p>

<h3>下記実行して再トライ</h3>

<p>$ export CONFIGURE_OPTS="--with-arch=i386 --with-readline-dir=/usr/local/Cellar/readline/6.2.2"</p>
]]></content>
  </entry>
  
</feed>
